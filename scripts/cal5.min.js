function chooseCalendar(n, t) {
  $("#hEventTypeID").val(n);
  $("#chooseCalendar").slideUp();
  $("#chooseTimeZone").slideDown();
  $("#calendarName").html(t)
}

function startOver() {
  stopEndlessLoopOfMonths = 0;
  $(".responsive-calendar").responsiveCalendar(startDate);
  $("#chooseAppointment").slideUp();
  $("#chooseTimeZone").slideUp();
  $("#appointmentForm").slideUp();
  $("#appointmentConfirmed").slideUp();
  $("#appointmentList").html('<h4><i id="chooseDateArrow" class="fa fa-arrow-left"><\/i>&nbsp;Choose a Date On The Calendar<\/h4>');
  var n = getQueryString("cal");
  n.length > 0 ? skipForSingle() : $("#chooseCalendar").slideDown();
  window.outerWidth < 784 && $("#chooseDateArrow").remove()
}

function chooseTimeZone() {
  tz = $("#timezone-offset").val();
  $("#hTimeZone").val(tz);
  $("#chooseTimeZone").slideUp();
  $("#chooseAppointment").slideDown();
  $("#confirmationTimeZone").html($("#timezone-offset :selected").text());
  var t = new Date,
    n = t.getMonth() + 1;
  n === 13 && (n = 1);
  getEvents(n, t.getFullYear())
}

function getAppointmentList(n, t, i) {
  var r = $("#hEventTypeID").val(),
    u = $("#hTimeZoneOlson").val(),
    f = $("#hTimeZone").val(),
    e = "action=getAppointmentList&month=" + n + "&day=" + t + "&year=" + i + "&eventTypeID=" + r + "&locationID=" + locID + "&ourTZ=" + u + "&theirTZ=" + f;
  $.ajax({
    type: "POST",
    async: !1,
    url: "events.ashx",
    data: e,
    dataType: "html",
    error: function () {
      return !1
    },
    success: function (r) {
      var f = i + "-" + n + "-" + t,
        u = moment(f).format("dddd, MMMM Do, YYYY"),
        e = $("#timezone-offset :selected").text();
      r = "<h4>Now Choose A Time:<\/h4><strong>Appointments for " + u + "<\/strong><p>Times shown in " + e + '<br><a href="javascript:;" onclick="changeTimeZones();">change time zone<\/a><\/p><p>&nbsp;<\/p>' + r;
      $("#appointmentList").html(r);
      $("#confirmationDate").html(u);
      location.href = "#";
      location.href = "#appointmentList"
    }
  })
}

function getEvents(n, t) {
  var i = $("#hEventTypeID").val(),
    r = $("#hTimeZone").val(),
    u = "action=getCalendarEvents&month=" + n + "&year=" + t + "&eventTypeID=" + i + "&theirTZ=" + r;
  $.ajax({
    type: "POST",
    async: !1,
    url: "events.ashx",
    data: u,
    dataType: "text",
    error: function () {
      return !1
    },
    success: function (n) {
      if (n.length > 0) {
        var t = JSON.parse("{" + n + "}");
        $(".responsive-calendar").responsiveCalendar("edit", t);
        stopEndlessLoopOfMonths = 0
      } else
        stopEndlessLoopOfMonths += 1,
        stopEndlessLoopOfMonths < 4 && $(".responsive-calendar").responsiveCalendar("next")
    }
  })
}

function setAppointment(n, t, i) {
  $("#hEventID").val(n);
  i.length > 0 ? ($("#hRedirectURL").val(i),
    $("#redirectURLSection").slideDown(),
    $("#redirectURL").attr("href", i)) : ($("#redirectURLSection").slideUp(),
    $("#hRedirectURL").val(""),
    $("#redirectURL").attr("href", ""));
  $("#chooseAppointment").slideUp();
  $("#appointmentForm").slideDown();
  $("#confirmationTime").html(t.slice(0, t.indexOf(" -")))
}

function changeTimeZones() {
  $("#chooseAppointment").slideUp();
  $("#chooseTimeZone").slideDown();
  $("#appointmentList").html('<h4><i id="chooseDateArrow" class="fa fa-arrow-left"><\/i>&nbsp;Choose a Date On The Calendar<\/h4>');
  window.outerWidth < 784 && $("#chooseDateArrow").remove()
}

function bookit() {
  var n = jQuery("#form1").validationEngine("validate");
  if (n == !1)
    return !1;
  var t = $("#txtName").val(),
    i = $("#txtEmail").val(),
    r = $("#txtMobile").val(),
    u = $("#txtComments").val(),
    f = $("#hReplacementID").val(),
    e = $("#hEventID").val(),
    o = $("#hTimeZone").val(),
    s = "action=saveAppointment&eventID=" + e + "&name=" + t + "&email=" + i + "&mobile=" + r + "&comments=" + u + "&tzolson=" + o + "&locID=" + locID + "&contactID=" + contact_ID + "&re=" + f;
  $.ajax({
    type: "POST",
    async: !1,
    url: "Calendar.ashx?l=" + locID,
    data: s,
    dataType: "json",
    error: function () {
      return swal("Something Went Wrong", "There was a problem, try again.", "warning"),
        !1
    },
    success: function (n) {
      $(".start").html(n.start);
      $(".end").html(n.end);
      $(".timezone").html(n.timezone);
      $(".title").html(n.title);
      $(".description").html(n.description);
      $(".location").html(n.location);
      $(".organizer").html(n.organizer);
      $(".organizer_email").html(n.organizer_email);
      $(".date_format").html(n.date_format);
      $(".facebook_event").html("");
      $(".all_day_event").html("");
      $("#appointmentForm").slideUp();
      $("#appointmentConfirmed").slideDown("fast")
    }
  })
}

function resizeIframe(n) {
  n.style.height = n.contentWindow.document.body.scrollHeight + "px"
}
var locID = $("#hLocationID").val(),
  contact_ID = $("#hContactID").val(),
  tz, startDate = $("#hStartDate").val(),
  stopEndlessLoopOfMonths = 0;
$(document).ready(function () {
  var r;
  $(".responsive-calendar").responsiveCalendar({
    time: startDate,
    startFromSunday: !0,
    onDayClick: function (n) {
      var t = this.attributes["data-month"].value,
        i = this.attributes["data-day"].value,
        r = this.attributes["data-year"].value,
        o = r + "-" + t + "-" + i,
        u, f, e;
      i.length === 1 && (i = "0" + i);
      t.length === 1 && (t = "0" + t);
      u = r + "-" + t + "-" + i;
      n.hasOwnProperty(u) ? getAppointmentList(t, i, r) : (f = moment(o).format("dddd, MMMM Do, YYYY"),
        e = '<a href="javascript:;" class="list-group-item text-ellipsis"><span> Appointments for ' + f + '<\/span><\/a><a href="#" class="alert list-group-item text-ellipsis">No appointments found on this day.<\/a>',
        $("#appointmentList").html(e))
    },
    onInit: function () {},
    onMonthChange: function () {
      var n = this.currentMonth + 1,
        t;
      n === 13 && (n = 1);
      t = this.currentYear;
      getEvents(n, t)
    }
  });
  window.outerWidth < 784 && $("#chooseDateArrow").remove();
  switch ($("#hTimeZoneOlson").val()) {
    case "America/New_York":
    case "America/Indiana/Indianapolis":
      $("#timezone-offset").val("US/Eastern");
      break;
    case "Australia/Victoria":
    case "Australia/Queensland":
      $("#timezone-offset").val("Australia/Brisbane");
      break;
    case "America/Denver":
      $("#timezone-offset").val("US/Mountain");
      break;
    case "America/Chicago":
    case "America/Guatemala":
      $("#timezone-offset").val("US/Central");
      break;
    case "Africa/Johannesburg":
      $("#timezone-offset").val("Africa/Cairo");
      break;
    case "Europe/Berlin":
      $("#timezone-offset").val("Europe/Amsterdam");
      break;
    case "America/Phoenix":
      $("#timezone-offset").val("US/Arizona");
      break;
    case "Africa/Timbuktu":
    case "Europe/London":
      $("#timezone-offset").val("Europe/London");
      break;
    case "Europe/Brussels":
      $("#timezone-offset").val("Europe/Paris");
      break;
    case "America/Halifax":
      $("#timezone-offset").val("Canada/Atlantic");
      break;
    case "Australia/Sydney":
      $("#timezone-offset").val("Australia/Canberra");
      break;
    default:
      $("#timezone-offset").val($("#hTimeZoneOlson").val())
  }
  var n = $("#hEmail").val(),
    t = $("#hFullName").val(),
    i = $("#hMobile").val();
  n.length > 0 && $("#txtEmail").val(n);
  t.length > 0 && $("#txtName").val(t);
  i.length > 0 && $("#txtMobile").val(i);
  $("#hEventTypeID").val().length > 0 && (r = $("#hEventTypeID").val(),
    $("#calendar" + r).click());
  self !== top && $(".topBar").remove()
});